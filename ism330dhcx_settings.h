/*
 * ism330dhcx_settings.h
 *
 *  Created on: Feb 4, 2025
 *      Author: filip
 */

#if defined(STM32F407xx) || defined(STM32F401xE)
	#include "stm32f4xx_hal.h"
#elif defined(STM32G431xx) || defined(STM32G441xx)
	#include "stm32g4xx_hal.h"
#else

#endif

extern I2C_HandleTypeDef hi2c1;
extern DMA_HandleTypeDef hdma_i2c1_rx;
extern DMA_HandleTypeDef hdma_i2c1_tx;

#define ISM_FS_ACC_2G_SENSITIVITY  0.061
#define ISM_FS_ACC_4G_SENSITIVITY  0.122
#define ISM_FS_ACC_8G_SENSITIVITY  0.244
#define ISM_FS_ACC_16G_SENSITIVITY 0.488

#define ISM_FS_GYRO_125_SENSITIVITY    4.375
#define ISM_FS_GYRO_250_SENSITIVITY    8.750
#define ISM_FS_GYRO_500_SENSITIVITY   17.500
#define ISM_FS_GYRO_1000_SENSITIVITY  35.000
#define ISM_FS_GYRO_2000_SENSITIVITY  70.000
#define ISM_FS_GYRO_4000_SENSITIVITY 140.000

#define ISM_ZERO_RATE_LEVEL_GYRO 4.0

#ifndef INC_ISM330DHCX_SETTINGS_H_
#define INC_ISM330DHCX_SETTINGS_H_

typedef enum {
	ISM_OK=0, ISM_ERROR=1, ISM_ERROR_WHOAMI, ISM_ERROR_SW,
	ISM_ERROR_CONFIG_BIT, ISM_ERROR_BDU,
	ISM_ERROR_FS_GYRO, ISM_ERROR_FS_ACC,
	ISM_ERROR_ODR_GYRO, ISM_ERROR_ODR_ACC,
	ISM_ERROR_READ, ISM_ERROR_WRITE, ISM_ERROR_SET_REG,
	ISM_NONE=-1
} ISM330DHCX_Status;

typedef enum {
	ISM_POWER_DOWN = 0,
	ISM_ODR_1HZ6   = 0b1011,
	ISM_ODR_12HZ5  = 0b0001,
	ISM_ODR_26HZ   = 0b0010,
	ISM_ODR_52HZ   = 0b0011,
	ISM_ODR_104HZ  = 0b0100,
	ISM_ODR_208HZ  = 0b0101,
	ISM_ODR_416HZ  = 0b0110,
	ISM_ODR_833HZ  = 0b0111,
	ISM_ODR_1666HZ = 0b1000,
	ISM_ODR_3333HZ = 0b1001,
	ISM_ODR_6666HZ = 0b1010
} ISM330DHCX_ODR;

typedef enum {
	ISM_FS_ACC_2G  = 0b00,
	ISM_FS_ACC_4G  = 0b10,
	ISM_FS_ACC_8G  = 0b11,
	ISM_FS_ACC_16G = 0b01
}ISM330DHCX_FS_ACCELEROMETER;

typedef enum {
	ISM_FS_GYRO_125  = 0b0010,
	ISM_FS_GYRO_250  = 0b0000,
	ISM_FS_GYRO_500  = 0b0100,
	ISM_FS_GYRO_1000 = 0b1000,
	ISM_FS_GYRO_2000 = 0b1100,
	ISM_FS_GYRO_4000 = 0b0001
}ISM330DHCX_FS_GYROSCOPE;

ISM330DHCX_Status __reset_I2C1_LINE();

ISM330DHCX_Status __init_DMA();
ISM330DHCX_Status __init_I2C();
ISM330DHCX_Status __init_GPIO();

#endif /* INC_ISM330DHCX_SETTINGS_H_ */
